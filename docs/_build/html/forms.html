

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Forms &mdash; Revit Python Wrapper 1.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Revit Python Wrapper 1.1.1 documentation" href="index.html"/>
        <link rel="next" title="Utilities" href="utils.html"/>
        <link rel="prev" title="Geometry" href="geometry.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Revit Python Wrapper
          

          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Revit Python Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="revit.html">Revit</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Base Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="element.html">Element Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection.html">Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="collector.html">Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="builtins.html">BuiltIns</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Forms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quickforms">QuickForms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selectfromlist">SelectFromList</a></li>
<li class="toctree-l3"><a class="reference internal" href="#textinput">TextInput</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#taskdialogs">TaskDialogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#alert">Alert</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#os-dialogs">OS Dialogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#select-folder">Select Folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-file">Select File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#console">Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flexform">FlexForm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#flexform-controls">FlexForm Controls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamo.html">Dynamo</a></li>
<li class="toctree-l1"><a class="reference internal" href="revitpythonshell.html">RevitPythonShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Revit Python Wrapper</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Forms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/forms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-rpw.ui.forms">
<span id="forms"></span><h1>Forms<a class="headerlink" href="#module-rpw.ui.forms" title="Permalink to this headline">¶</a></h1>
<p>The forms module provide several pre-build forms as well as a framework
from which you can build your own forms.</p>
<div class="section" id="quickforms">
<h2>QuickForms<a class="headerlink" href="#quickforms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="selectfromlist">
<h3>SelectFromList<a class="headerlink" href="#selectfromlist" title="Permalink to this headline">¶</a></h3>
<img alt="_images/select-from-list.png" src="_images/select-from-list.png" />
<dl class="function">
<dt id="rpw.ui.forms.SelectFromList">
<code class="descclassname">rpw.ui.forms.</code><code class="descname">SelectFromList</code><span class="sig-paren">(</span><em>title</em>, <em>options</em>, <em>description=None</em>, <em>sort=True</em>, <em>exit_on_close=True</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.SelectFromList" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple FlexForm wrapped function with ComboBox and button</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>title</strong> (<em>str</em>) – Title of form</li>
<li><strong>options</strong> (<em>dict</em><em>,</em><em>list</em><em>[</em><em>str</em><em>]</em>) – Dictionary (string keys) or List[strings]</li>
<li><strong>description</strong> (<em>str</em>) – Optional Description of input requested  [default: None]</li>
<li><strong>sort</strong> (<em>bool</em>) – Optional sort flag - sorts keys [default: True]</li>
<li><strong>exit_on_close</strong> (<em>bool</em>) – Form will call sys.exit() if Closed on X. [default: True]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Usage:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Test Window&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Dropdown shows &#39;1&#39;, &#39;2&#39; ,&#39;3&#39;. User clicks Select &#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="go">&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Dictionary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Test Window&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Text&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># User clicks Text</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="go">str</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="textinput">
<h3>TextInput<a class="headerlink" href="#textinput" title="Permalink to this headline">¶</a></h3>
<img alt="_images/text-input.png" src="_images/text-input.png" />
<dl class="function">
<dt id="rpw.ui.forms.TextInput">
<code class="descclassname">rpw.ui.forms.</code><code class="descname">TextInput</code><span class="sig-paren">(</span><em>title</em>, <em>default=None</em>, <em>description=None</em>, <em>sort=True</em>, <em>exit_on_close=True</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.TextInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple FlexForm wrapped function with TextBox and button</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>title</strong> (<em>str</em>) – Title of form</li>
<li><strong>default</strong> (<em>str</em>) – Optional default value for text box [default: None]</li>
<li><strong>description</strong> (<em>str</em>) – Optional Description of input requested  [default: None]</li>
<li><strong>exit_on_close</strong> (<em>bool</em>) – Form will call sys.exit() if Closed on X. [default: True]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Usage:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="taskdialogs">
<h2>TaskDialogs<a class="headerlink" href="#taskdialogs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="alert">
<h3>Alert<a class="headerlink" href="#alert" title="Permalink to this headline">¶</a></h3>
<img alt="_images/alert.png" src="_images/alert.png" />
<dl class="class">
<dt id="rpw.ui.forms.Alert">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">Alert</code><span class="sig-paren">(</span><em>message</em>, <em>title=’Alert’</em>, <em>heading=”</em>, <em>exit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Alert" title="Permalink to this definition">¶</a></dt>
<dd><p>A Simple Revit TaskDialog for displaying quick messages</p>
<dl class="method">
<dt id="rpw.ui.forms.Alert.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>message</em>, <em>title=’Alert’</em>, <em>heading=”</em>, <em>exit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Alert.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> (<em>str</em>) – TaskDialog Message</li>
<li><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – TaskDialog Title</li>
<li><strong>heading</strong> (<em>str</em><em>, </em><em>optional</em>) – TaskDialog Message Heading</li>
<li><strong>exit</strong> (<em>bool</em><em>, </em><em>optional</em>) – Exit Script after Dialog. Useful for displayin Errors. Default is False</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Usage:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Alert</span><span class="p">(</span><span class="s1">&#39;Your Message&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="s2">&quot;Some Heading&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Alert</span><span class="p">(</span><span class="s1">&#39;You need to select Something&#39;</span><span class="p">,</span> <span class="n">exit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="os-dialogs">
<h2>OS Dialogs<a class="headerlink" href="#os-dialogs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="select-folder">
<h3>Select Folder<a class="headerlink" href="#select-folder" title="Permalink to this headline">¶</a></h3>
<img alt="_images/select_folder.png" src="_images/select_folder.png" />
<dl class="function">
<dt id="rpw.ui.forms.select_folder">
<code class="descclassname">rpw.ui.forms.</code><code class="descname">select_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.select_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a Folder Path using the standard OS Dialog.
Uses Forms.FolderBrowserDialog(). For more information see:
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog">https://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folderpath</span> <span class="o">=</span> <span class="n">select_folder</span><span class="p">()</span>
<span class="go">&#39;C:\folder\path&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="select-file">
<h3>Select File<a class="headerlink" href="#select-file" title="Permalink to this headline">¶</a></h3>
<img alt="_images/select_file.png" src="_images/select_file.png" />
<dl class="function">
<dt id="rpw.ui.forms.select_file">
<code class="descclassname">rpw.ui.forms.</code><code class="descname">select_file</code><span class="sig-paren">(</span><em>extensions=’All Files (*.*)|*.*’</em>, <em>title=’Select File’</em>, <em>multiple=False</em>, <em>restore_directory=True</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.select_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a File Path using the standard OS Dialog.
Uses Forms.OpenFileDialog
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter">https://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">select_file</span><span class="p">(</span><span class="s1">&#39;Revit File (&#39;</span><span class="o">*.</span><span class="n">rvt</span><span class="p">)</span><span class="o">|*.</span><span class="n">rvt</span><span class="s1">&#39;)</span>
<span class="go">&#39;C:\folder\file.rvt&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>extensions</strong> (<em>str</em><em>, </em><em>optional</em>) – File Extensions Filtering options. Default is All Files (<em>.</em>)|*.*</li>
<li><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – File Extensions Filtering options</li>
<li><strong>multiple</strong> (<em>bool</em>) – Allow selection of multiple files. Default is <cite>False</cite></li>
<li><strong>restore_directory</strong> (<em>bool</em>) – Restores the directory to the previously selected directory before closing</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="console">
<h2>Console<a class="headerlink" href="#console" title="Permalink to this headline">¶</a></h2>
<img alt="_images/console.png" src="_images/console.png" />
<span class="target" id="module-rpw.ui.forms.console"></span><p>REPL Console for Inspecting Stack</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rpw.ui.forms</span> <span class="k">import</span> <span class="n">Console</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Console</span><span class="p">()</span>
<span class="go"># Console is launched with locally defined variables injected into context.</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Keyboard Shortcuts:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">UP</span></code>  Iterate history up</li>
<li><code class="docutils literal"><span class="pre">Down</span></code>  Iterate history down</li>
<li><code class="docutils literal"><span class="pre">Tab</span></code>  Iterate possible autocomplete options</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The last stack frame is automatically injected is the context of the evaluation
loop of the console: the local and global variables from where the Console
was called from should be available.</p>
<p>Inspection of the stack requires <cite>stack frames</cite> to be enabled.
If an exception is raised stating <code class="docutils literal"><span class="pre">`object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'_getframe'</span></code>
it means IronPython stack frames is not enabled.
You can enable it by running with the <code class="docutils literal"><span class="pre">-X</span></code> argument:
<code class="docutils literal"><span class="pre">ipy.exe</span> <span class="pre">-X:</span> <span class="pre">FullFrames</span> <span class="pre">file.py</span></code>.</p>
<p>If you are trying to use it from within Dynamo, stack inspection is
currently not available due to how the engine is setup,
but you can still use it by manually passing the context you want to inspect:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Console</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span>  <span class="c1"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Console</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="nb">globals</span><span class="p">())</span>
</pre></div>
</div>
</div>
<dl class="class">
<dt id="rpw.ui.forms.Console">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">Console</code><span class="sig-paren">(</span><em>stack_level=1</em>, <em>stack_info=True</em>, <em>context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Console" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="flexform">
<h2>FlexForm<a class="headerlink" href="#flexform" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rpw.ui.forms.FlexForm">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">FlexForm</code><span class="sig-paren">(</span><em>title</em>, <em>components</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.FlexForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Flex Form Usage</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Pick Style:&#39;</span><span class="p">),</span>
<span class="go">                  ComboBox(&#39;combobox1&#39;, {&#39;Opt 1&#39;: 10.0, &#39;Opt 2&#39;, 20.0}),</span>
<span class="go">                  Label(&#39;Enter Name:&#39;),</span>
<span class="go">                  TextBox(&#39;textbox1&#39;, Text=&quot;Default Value&quot;),</span>
<span class="go">                  CheckBox(&#39;checkbox1&#39;, &#39;Check this&#39;),</span>
<span class="go">                  Separator(),</span>
<span class="go">                  Button(&#39;Select&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">=</span> <span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># User selects `Opt 1`, types &#39;Wood&#39; in TextBox, and select Checkbox</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span><span class="o">.</span><span class="n">values</span>
<span class="go">{&#39;combobox1&#39;: 10.0, &#39;textbox1&#39;: &#39;Wood&#39;, &#39;checkbox&#39;: True}</span>
</pre></div>
</div>
</dd></dl>

<img alt="_images/flexform.png" src="_images/flexform.png" />
<div class="section" id="flexform-controls">
<h3>FlexForm Controls<a class="headerlink" href="#flexform-controls" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="rpw.ui.forms.Label">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">Label</code><span class="sig-paren">(</span><em>label_text</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Label" title="Permalink to this definition">¶</a></dt>
<dd><p>Windows.Controls.Label Wrapper</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Label Text&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="rpw.ui.forms.TextBox">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">TextBox</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.TextBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Windows.Controls.TextBox Wrapper</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TextBox</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="rpw.ui.forms.CheckBox">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">CheckBox</code><span class="sig-paren">(</span><em>name</em>, <em>checkbox_text</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.CheckBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Windows.Controls.Checkbox Wrapper</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CheckBox</span><span class="p">(</span><span class="s1">&#39;Label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="rpw.ui.forms.ComboBox">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">ComboBox</code><span class="sig-paren">(</span><em>name</em>, <em>options</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.ComboBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Windows.Controls.ComboBox Wrapper</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ComboBox</span><span class="p">({</span><span class="s1">&#39;Option 1&#39;</span><span class="p">:</span> <span class="n">Element</span><span class="p">,</span> <span class="s1">&#39;Option 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Elemnet&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="rpw.ui.forms.Separator">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">Separator</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Separator" title="Permalink to this definition">¶</a></dt>
<dd><p>WPF Separator</p>
</dd></dl>

<dl class="class">
<dt id="rpw.ui.forms.Button">
<em class="property">class </em><code class="descclassname">rpw.ui.forms.</code><code class="descname">Button</code><span class="sig-paren">(</span><em>button_text</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rpw.ui.forms.Button" title="Permalink to this definition">¶</a></dt>
<dd><p>Windows.Controls.Button Wrapper</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Select&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<hr class="docutils" />
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>FlexForm</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">count</span>

<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">rpw.ui.forms.resources</span> <span class="k">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">FlexForm</span><span class="p">(</span><span class="n">Window</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flex Form Usage</span>

<span class="sd">    &gt;&gt;&gt; components = [Label(&#39;Pick Style:&#39;),</span>
<span class="sd">                      ComboBox(&#39;combobox1&#39;, {&#39;Opt 1&#39;: 10.0, &#39;Opt 2&#39;, 20.0}),</span>
<span class="sd">                      Label(&#39;Enter Name:&#39;),</span>
<span class="sd">                      TextBox(&#39;textbox1&#39;, Text=&quot;Default Value&quot;),</span>
<span class="sd">                      CheckBox(&#39;checkbox1&#39;, &#39;Check this&#39;),</span>
<span class="sd">                      Separator(),</span>
<span class="sd">                      Button(&#39;Select&#39;)]</span>
<span class="sd">    &gt;&gt;&gt; form = FlexForm(&#39;Title&#39;, components)</span>
<span class="sd">    &gt;&gt;&gt; form.show()</span>
<span class="sd">    &gt;&gt;&gt; # User selects `Opt 1`, types &#39;Wood&#39; in TextBox, and select Checkbox</span>
<span class="sd">    &gt;&gt;&gt; form.values</span>
<span class="sd">    {&#39;combobox1&#39;: 10.0, &#39;textbox1&#39;: &#39;Wood&#39;, &#39;checkbox&#39;: True}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;Window</span>
<span class="s2">                xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
<span class="s2">                xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
<span class="s2">                xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span>
<span class="s2">                xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span>
<span class="s2">                xmlns:local=&quot;clr-namespace:WpfApplication1&quot; mc:Ignorable=&quot;d&quot;</span>
<span class="s2">                ResizeMode=&quot;NoResize&quot;</span>
<span class="s2">                WindowStartupLocation=&quot;CenterScreen&quot;</span>
<span class="s2">                Topmost=&quot;True&quot;</span>
<span class="s2">                SizeToContent=&quot;WidthAndHeight&quot;&gt;</span>

<span class="s2">                &lt;Grid Name=&quot;MainGrid&quot; Margin=&quot;10,10,10,10&quot;&gt;</span>
<span class="s2">                &lt;/Grid&gt;</span>
<span class="s2">            &lt;/Window&gt;</span>
<span class="s2">            &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            title (``str``): Form Title</span>
<span class="sd">            components (``list``): List of Form Components.</span>
<span class="sd">            top_offset (``float``): Optional top offset.</span>
<span class="sd">            options (``kwargs``): WPF Parameters Options</span>

<span class="sd">        Attributes:</span>
<span class="sd">            values (``dict``): Dictionary of selected values</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">wpf</span><span class="o">.</span><span class="n">LoadComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StringReader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MainGrid</span><span class="o">.</span><span class="n">Children</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s1">&#39;on_click&#39;</span><span class="p">):</span>
                <span class="n">component</span><span class="o">.</span><span class="n">Click</span> <span class="o">+=</span> <span class="n">component</span><span class="o">.</span><span class="n">on_click</span>

            <span class="n">V_SPACE</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prev_comp</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">prev_comp</span><span class="o">.</span><span class="n">Margin</span><span class="o">.</span><span class="n">Top</span> <span class="o">+</span> <span class="n">prev_comp</span><span class="o">.</span><span class="n">Height</span> <span class="o">+</span> <span class="n">V_SPACE</span>
                <span class="n">top</span> <span class="o">+=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s1">&#39;top_offset&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">component</span><span class="o">.</span><span class="n">Margin</span> <span class="o">=</span> <span class="n">Thickness</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes Form. Returns ``True`` or ``False`` if form was exited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Default Get Values. Collect values from controls and close &quot;&quot;&quot;</span>
        <span class="n">component_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">GetWindow</span><span class="p">(</span><span class="n">sender</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">window</span><span class="o">.</span><span class="n">MainGrid</span><span class="o">.</span><span class="n">Children</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">component_values</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">Name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">window</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">component_values</span>
        <span class="n">window</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Exits Form. Returns ``True`` to ``show()`` method &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DialogResult</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">RpwControlMixin</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Control Mixin &quot;&quot;&quot;</span>
    <span class="n">_index</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Parses kwargs, sets default values where appropriate. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">)</span>  <span class="c1"># Counts Instatiation to control Height</span>

        <span class="c1"># Default Values</span>
        <span class="n">control_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">control_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Width&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Height&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

        <span class="n">h_align</span> <span class="o">=</span> <span class="n">Enum</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">HorizontalAlignment</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h_align&#39;</span><span class="p">,</span> <span class="s1">&#39;Left&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HorizontalAlignment</span> <span class="o">=</span> <span class="n">h_align</span>
        <span class="n">v_align</span> <span class="o">=</span> <span class="n">Enum</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">VerticalAlignment</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;v_align&#39;</span><span class="p">,</span> <span class="s1">&#39;Top&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VerticalAlignment</span> <span class="o">=</span> <span class="n">v_align</span>

        <span class="c1"># Inject Any other Custom Values into Component</span>
        <span class="c1"># Updating __dict__ fails due to how .NET inheritance/properties works</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Label</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">Label</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Windows.Controls.Label Wrapper</span>

<span class="sd">    &gt;&gt;&gt; Label(&#39;Label Text&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            label_text (``str``): Label Text</span>
<span class="sd">            wpf_params (kwargs): Additional WPF attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Content</span> <span class="o">=</span> <span class="n">label_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TextBox</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">TextBox</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Windows.Controls.TextBox Wrapper</span>

<span class="sd">    &gt;&gt;&gt; TextBox()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            name (``str``): Name of control. Will be used to return value</span>
<span class="sd">            wpf_params (kwargs): Additional WPF attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Height&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">25</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Text</span>


<span class="k">class</span> <span class="nc">Button</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Windows.Controls.Button Wrapper</span>

<span class="sd">    &gt;&gt;&gt; Button(&#39;Select&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            button_text (``str``): Button Text</span>
<span class="sd">            wpf_params (kwargs): Additional WPF attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Content</span> <span class="o">=</span> <span class="n">button_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Click&#39;</span><span class="p">,</span> <span class="n">FlexForm</span><span class="o">.</span><span class="n">get_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CheckBox</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Windows.Controls.Checkbox Wrapper</span>

<span class="sd">    &gt;&gt;&gt; CheckBox(&#39;Label&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">checkbox_text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            name (``str``): Name of control. Will be used to return value</span>
<span class="sd">            checkbox_text (``str``): Checkbox label Text</span>
<span class="sd">            wpf_params (kwargs): Additional WPF attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Content</span> <span class="o">=</span> <span class="n">checkbox_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="n">top_offset</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsChecked</span>


<span class="k">class</span> <span class="nc">ComboBox</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Windows.Controls.ComboBox Wrapper</span>

<span class="sd">    &gt;&gt;&gt; ComboBox({&#39;Option 1&#39;: Element, &#39;Option 2&#39;, &#39;Elemnet&#39;})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            name (``str``): Name of control. Will be used to return value</span>
<span class="sd">            options (``list``, ``dict``): If ``dict``, selected value is returned</span>
<span class="sd">            wpf_params (kwargs): Additional WPF attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">options</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ItemsSource</span> <span class="o">=</span> <span class="n">options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SelectedItem</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SelectedItem</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">selected</span>

<span class="k">class</span> <span class="nc">Separator</span><span class="p">(</span><span class="n">RpwControlMixin</span><span class="p">,</span> <span class="n">Controls</span><span class="o">.</span><span class="n">Separator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; WPF Separator &quot;&quot;&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; TESTS &quot;&quot;&quot;</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
                  <span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Pick Style:&#39;</span><span class="p">),</span>
                  <span class="n">ComboBox</span><span class="p">(</span><span class="s1">&#39;combobox1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Opt 1&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;Opt 2&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">}),</span>
                  <span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Enter Name:&#39;</span><span class="p">),</span>
                  <span class="n">TextBox</span><span class="p">(</span><span class="s1">&#39;textbox1&#39;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="s2">&quot;Default Value&quot;</span><span class="p">),</span>
                  <span class="n">CheckBox</span><span class="p">(</span><span class="s1">&#39;checkbox1&#39;</span><span class="p">,</span> <span class="s1">&#39;Check this:&#39;</span><span class="p">),</span>
                  <span class="n">Separator</span><span class="p">(),</span>
                  <span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Select&#39;</span><span class="p">)]</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
    <span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p>QuickForm</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">rpw.ui.forms.flexform</span> <span class="k">import</span> <span class="n">FlexForm</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="n">ComboBox</span><span class="p">,</span> <span class="n">TextBox</span><span class="p">,</span> <span class="n">Button</span>

<span class="k">def</span> <span class="nf">SelectFromList</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Simple FlexForm wrapped function with ComboBox and button</span>

<span class="sd">    Args:</span>
<span class="sd">        title (str): Title of form</span>
<span class="sd">        options (dict,list[str]): Dictionary (string keys) or List[strings]</span>
<span class="sd">        description (str): Optional Description of input requested  [default: None]</span>
<span class="sd">        sort (bool): Optional sort flag - sorts keys [default: True]</span>
<span class="sd">        exit_on_close (bool): Form will call sys.exit() if Closed on X. [default: True]</span>

<span class="sd">    Usage:</span>
<span class="sd">        &gt;&gt;&gt; value = SelectFromList(&#39;Test Window&#39;, [&#39;1&#39;,&#39;2&#39;,&#39;3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; # Dropdown shows &#39;1&#39;, &#39;2&#39; ,&#39;3&#39;. User clicks Select &#39;1&#39;</span>
<span class="sd">        &gt;&gt;&gt; print(value)</span>
<span class="sd">        &#39;1&#39;</span>
<span class="sd">        &gt;&gt;&gt; # Dictionary</span>
<span class="sd">        &gt;&gt;&gt; value = SelectFromList(&#39;Test Window&#39;, {&#39;Text&#39;:str, &#39;Number&#39;:int})</span>
<span class="sd">        &gt;&gt;&gt; # User clicks Text</span>
<span class="sd">        &gt;&gt;&gt; print(value)</span>
<span class="sd">        str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Label</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>
    <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComboBox</span><span class="p">(</span><span class="s1">&#39;combobox&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">))</span>
    <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Select&#39;</span><span class="p">))</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;SelectFromList&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span> <span class="n">exit_on_close</span><span class="o">=</span><span class="n">exit_on_close</span><span class="p">)</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;combobox&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">exit_on_close</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">TextInput</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Simple FlexForm wrapped function with TextBox and button</span>

<span class="sd">    Args:</span>
<span class="sd">        title (str): Title of form</span>
<span class="sd">        default (str): Optional default value for text box [default: None]</span>
<span class="sd">        description (str): Optional Description of input requested  [default: None]</span>
<span class="sd">        exit_on_close (bool): Form will call sys.exit() if Closed on X. [default: True]</span>

<span class="sd">    Usage:</span>
<span class="sd">        &gt;&gt;&gt; value = TextInput(&#39;Title&#39;, default=&quot;3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(value)</span>
<span class="sd">        3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Label</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">default</span><span class="p">:</span>
        <span class="n">textbox</span> <span class="o">=</span> <span class="n">TextBox</span><span class="p">(</span><span class="s1">&#39;textbox&#39;</span><span class="p">,</span> <span class="n">Text</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">textbox</span> <span class="o">=</span> <span class="n">TextBox</span><span class="p">(</span><span class="s1">&#39;textbox&#39;</span><span class="p">)</span>
    <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">textbox</span><span class="p">)</span>
    <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Select&#39;</span><span class="p">))</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;TextInput&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">)</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;textbox&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">exit_on_close</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your Options&quot;</span><span class="p">,</span>
                            <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Your Options&quot;</span><span class="p">,</span>
                            <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="n">rv</span> <span class="o">=</span> <span class="n">TextInput</span><span class="p">(</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;forms.py ran&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>OS Dialogs</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">rpw.ui.forms.resources</span> <span class="k">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">select_folder</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects a Folder Path using the standard OS Dialog.</span>
<span class="sd">    Uses Forms.FolderBrowserDialog(). For more information see:</span>
<span class="sd">    https://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.</span>

<span class="sd">    &gt;&gt;&gt; folderpath = select_folder()</span>
<span class="sd">    &#39;C:\\folder\\path&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">Forms</span><span class="o">.</span><span class="n">FolderBrowserDialog</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span> <span class="o">==</span> <span class="n">Forms</span><span class="o">.</span><span class="n">DialogResult</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">SelectedPath</span>


<span class="k">def</span> <span class="nf">select_file</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;All Files (*.*)|*.*&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select File&quot;</span><span class="p">,</span>
                <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">restore_directory</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects a File Path using the standard OS Dialog.</span>
<span class="sd">    Uses Forms.OpenFileDialog</span>
<span class="sd">    https://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter</span>

<span class="sd">    &gt;&gt;&gt; filepath = select_file(&#39;Revit File (&#39;*.rvt)|*.rvt&#39;)</span>
<span class="sd">    &#39;C:\\folder\\file.rvt&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        extensions (str, optional): File Extensions Filtering options. Default is All Files (*.*)|*.*</span>
<span class="sd">        title (str, optional): File Extensions Filtering options</span>
<span class="sd">        multiple (bool): Allow selection of multiple files. Default is `False`</span>
<span class="sd">        restore_directory (bool): Restores the directory to the previously selected directory before closing</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">Forms</span><span class="o">.</span><span class="n">OpenFileDialog</span><span class="p">()</span>
    <span class="n">form</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">extensions</span>
    <span class="n">form</span><span class="o">.</span><span class="n">Title</span> <span class="o">=</span> <span class="n">title</span>
    <span class="n">form</span><span class="o">.</span><span class="n">Multiselect</span> <span class="o">=</span> <span class="n">multiple</span>
    <span class="n">form</span><span class="o">.</span><span class="n">RestoreDirectory</span> <span class="o">=</span> <span class="n">restore_directory</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span> <span class="o">==</span> <span class="n">Forms</span><span class="o">.</span><span class="n">DialogResult</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">FileName</span>

<span class="c1"># Tests</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">select_folder</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">select_file</span><span class="p">(</span><span class="s1">&#39;Python Files|*.py&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Console</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span> <span class="nn">rpw.ui.forms.resources</span> <span class="k">import</span> <span class="n">Window</span>
<span class="kn">from</span> <span class="nn">rpw.ui.forms.resources</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1"># logger.verbose(True)</span>

<span class="k">class</span> <span class="nc">Console</span><span class="p">(</span><span class="n">Window</span><span class="p">):</span>
    <span class="n">LAYOUT</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                &lt;Window xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
<span class="s2">                        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
<span class="s2">                        Title=&quot;DeployWindow&quot; Height=&quot;400&quot; Width=&quot;800&quot; SnapsToDevicePixels=&quot;True&quot;</span>
<span class="s2">                        UseLayoutRounding=&quot;True&quot; WindowState=&quot;Normal&quot; WindowStartupLocation=&quot;CenterScreen&quot;&gt;</span>
<span class="s2">                &lt;Window.Resources&gt;</span>
<span class="s2">                    &lt;Style TargetType=&quot;{x:Type MenuItem}&quot;&gt;</span>
<span class="s2">                        &lt;Setter Property=&quot;FontFamily&quot; Value=&quot;Consolas&quot;/&gt;</span>
<span class="s2">                        &lt;Setter Property=&quot;FontSize&quot; Value=&quot;12.0&quot;/&gt;</span>
<span class="s2">                    &lt;/Style&gt;</span>
<span class="s2">                &lt;/Window.Resources&gt;</span>
<span class="s2">                &lt;Grid&gt;</span>
<span class="s2">                    &lt;Grid.ColumnDefinitions&gt;</span>
<span class="s2">                        &lt;ColumnDefinition Width=&quot;*&quot;&gt;&lt;/ColumnDefinition&gt;</span>
<span class="s2">                    &lt;/Grid.ColumnDefinitions&gt;</span>
<span class="s2">                &lt;Grid.RowDefinitions&gt;</span>
<span class="s2">                    &lt;RowDefinition Height=&quot;0&quot;&gt;&lt;/RowDefinition&gt;</span>
<span class="s2">                    &lt;RowDefinition Height=&quot;*&quot;&gt;&lt;/RowDefinition&gt;</span>
<span class="s2">                &lt;/Grid.RowDefinitions&gt;</span>
<span class="s2">                &lt;TextBox Grid.Column=&quot;1&quot; Grid.Row=&quot;1&quot;  HorizontalAlignment=&quot;Stretch&quot;</span>
<span class="s2">                         Name=&quot;tbox&quot; Margin=&quot;6,6,6,6&quot; VerticalAlignment=&quot;Stretch&quot;</span>
<span class="s2">                         AcceptsReturn=&quot;True&quot; VerticalScrollBarVisibility=&quot;Auto&quot;</span>
<span class="s2">                         TextWrapping=&quot;Wrap&quot;</span>
<span class="s2">                         FontFamily=&quot;Consolas&quot; FontSize=&quot;12.0&quot;</span>
<span class="s2">                         /&gt;</span>
<span class="s2">                &lt;/Grid&gt;</span>
<span class="s2">                &lt;/Window&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="c1"># &lt;Button Grid.Column=&quot;1&quot; Content=&quot;Deploy&quot; Height=&quot;30&quot; Width=&quot;100&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;10,10,10,10&quot; Name=&quot;deployButton&quot; Cursor=&quot;Hand&quot; /&gt;</span>

    <span class="n">CARET</span> <span class="o">=</span> <span class="s1">&#39;&gt;&gt;&gt; &#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            stack_level (int): Default is 1. 0 Is the Console stack, 1 is the</span>
<span class="sd">                               caller; 2 is previous to that, etc.</span>
<span class="sd">            stack_info (bool): Display info about where call came from.</span>
<span class="sd">                               Will print filename name,  line no. and Caller</span>
<span class="sd">                               name.</span>
<span class="sd">            context (dict): Optional Dictionary for when inspection is not</span>
<span class="sd">                            possible.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># History Helper</span>
        <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;rpw-history&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack_level</span> <span class="o">=</span> <span class="n">stack_level</span>

        <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            <span class="c1"># Allows to pass context manually, so it can be used in Dynamo</span>
            <span class="c1"># Where inspection does not work</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Stack Info</span>
            <span class="c1"># stack_frame = inspect.currentframe().f_back</span>
            <span class="n">stack_frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">stack_level</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Finds Calling Stack</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">stack_frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">stack_frame</span><span class="o">.</span><span class="n">f_globals</span><span class="p">)</span>
            <span class="c1"># Debug Console</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;stack&#39;</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()})</span>

            <span class="n">stack_code</span> <span class="o">=</span> <span class="n">stack_frame</span><span class="o">.</span><span class="n">f_code</span>
            <span class="n">stack_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">stack_code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">)</span>
            <span class="n">stack_lineno</span> <span class="o">=</span> <span class="n">stack_code</span><span class="o">.</span><span class="n">co_firstlineno</span>
            <span class="n">stack_caller</span> <span class="o">=</span> <span class="n">stack_code</span><span class="o">.</span><span class="n">co_name</span>

        <span class="c1"># Form Setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">wpf</span><span class="o">.</span><span class="n">LoadComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">LAYOUT</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Title</span> <span class="o">=</span> <span class="s1">&#39;RevitPythonWrapper Console&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PreviewKeyDown</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KeyPressPreview</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">KeyUp</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnKeyUpHandler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_loaded</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Form Init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Focus</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span> <span class="ow">and</span> <span class="n">stack_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_line</span><span class="p">(</span><span class="s1">&#39;Caller: </span><span class="si">{}</span><span class="s1"> [ Line:</span><span class="si">{}</span><span class="s1">] | File: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stack_caller</span><span class="p">,</span> <span class="n">stack_lineno</span><span class="p">,</span> <span class="n">stack_filename</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">Console</span><span class="o">.</span><span class="n">CARET</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>

        <span class="c1"># Vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_options</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">GetLineText</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">):]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Get Line: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">line</span>

    <span class="k">def</span> <span class="nf">get_last_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Last Line: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">last_line</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">last_line</span>

    <span class="k">def</span> <span class="nf">get_last_entered_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Last Line: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">last_line</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">last_line</span>

    <span class="k">def</span> <span class="nf">get_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">last_line_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">LineCount</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_line_index</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lines: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">lines</span>

    <span class="k">def</span> <span class="nf">OnKeyUpHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="c1"># Need to use this to be able to override ENTER</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_loaded</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Enter</span><span class="p">:</span>
            <span class="n">entered_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_entered_line</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">entered_line</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_line</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">entered_line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_history</span><span class="p">(</span><span class="n">entered_line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_line</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">SyntaxError</span> <span class="k">as</span> <span class="n">errmsg</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">errmsg</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">errmsg</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">errmsg</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">errmsg</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">OnKeyDownHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">reset_caret</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">KeyPressPreview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="c1"># This Happens before all other key handlers</span>
        <span class="c1"># If e.Handled = True, stops event propagation here.</span>
        <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Up</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history_up</span><span class="p">()</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Down</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history_down</span><span class="p">()</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Left</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Back</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">):</span>
                <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_caret</span><span class="p">()</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Tab</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">autocomplete</span><span class="p">()</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Handled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">Key</span> <span class="o">==</span> <span class="n">Key</span><span class="o">.</span><span class="n">Enter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">autocomplete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Add recursive dir() attribute suggestions</span>

        <span class="n">last_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_line</span><span class="p">()</span>
        <span class="n">cursor_line_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">last_line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cursor_line_index</span><span class="p">]</span>
        <span class="n">possibilities</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack_locals</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">+</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">stack_globals</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">+</span>
                            <span class="p">[</span><span class="s1">&#39;locals&#39;</span><span class="p">,</span> <span class="s1">&#39;globals&#39;</span><span class="p">,</span> <span class="s1">&#39;vars&#39;</span><span class="p">]</span> <span class="o">+</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_history</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="c1"># Last 20 cmds</span>
                            <span class="p">)</span>
        <span class="n">suggestions</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">possibilities</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Text: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Sug: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suggestions</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">suggestions</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># Create Dictionary to Track iteration over suggestion</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac_options</span><span class="p">[</span><span class="n">text</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">suggestion</span> <span class="o">=</span> <span class="n">suggestions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ac_options</span><span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">suggestion</span> <span class="o">=</span> <span class="n">suggestions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac_options</span><span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">suggestion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">caret_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="n">caret_index</span>

    <span class="k">def</span> <span class="nf">write_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Used for Code Output</span>
        <span class="c1"># Writes line with no starting caret, new line + caret</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">NewLine</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="c1"># Used by Autocomplete and History</span>
        <span class="c1"># Adds text to line, including Caret</span>
        <span class="n">last_new_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">last_new_line</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">Console</span><span class="o">.</span><span class="n">CARET</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">CaretIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">tbox</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_all_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: Add clean up when history &gt; X</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">lines</span>

    <span class="k">def</span> <span class="nf">history_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_iter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">history_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_iter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Adding Line to History:&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_file</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">history_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_history</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Lines: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Wrap around lines to loop and up down infinetly.</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_index</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">line</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s1">&#39;&lt;rpw:Console stack_level=</span><span class="si">{}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack_level</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># Console()</span>
        <span class="n">Console</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span>
    <span class="n">test</span><span class="p">()</span>
    <span class="n">z</span> <span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>Resources</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">ABCMeta</span>

<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span>
<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">clr</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="c1"># WPF/Form Imports</span>
<span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;PresentationFramework&quot;</span><span class="p">)</span>  <span class="c1"># System.Windows: Controls, ?</span>
<span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;WindowsBase&quot;</span><span class="p">)</span>            <span class="c1"># System.Windows.Input</span>
<span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;System.Drawing&quot;</span><span class="p">)</span>         <span class="c1"># FontFamily</span>
<span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s1">&#39;System.Windows.Forms&#39;</span><span class="p">)</span> <span class="c1"># Forms</span>

<span class="kn">import</span> <span class="nn">System.Windows</span>
<span class="kn">from</span> <span class="nn">System.Windows</span> <span class="k">import</span> <span class="n">Window</span>
<span class="kn">from</span> <span class="nn">System.IO</span> <span class="k">import</span> <span class="n">StringReader</span>

<span class="c1"># Console</span>
<span class="kn">from</span> <span class="nn">System.Environment</span> <span class="k">import</span> <span class="n">Exit</span><span class="p">,</span> <span class="n">NewLine</span>
<span class="kn">from</span> <span class="nn">System.Drawing</span> <span class="k">import</span> <span class="n">FontFamily</span>
<span class="kn">from</span> <span class="nn">System.Windows.Input</span> <span class="k">import</span> <span class="n">Key</span>

<span class="c1"># FlexForm Imports</span>
<span class="kn">from</span> <span class="nn">System.Windows</span> <span class="k">import</span> <span class="n">Controls</span><span class="p">,</span> <span class="n">Window</span>
<span class="kn">from</span> <span class="nn">System.Windows</span> <span class="k">import</span> <span class="n">HorizontalAlignment</span><span class="p">,</span> <span class="n">VerticalAlignment</span><span class="p">,</span> <span class="n">Thickness</span>

<span class="c1"># OS Dialogs</span>
<span class="kn">from</span> <span class="nn">System.Windows</span> <span class="k">import</span> <span class="n">Forms</span>

<span class="k">if</span> <span class="n">revit</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;Dynamo&#39;</span><span class="p">:</span>
    <span class="c1"># IronPython 2.7.3 - Dynamo + RPS w/out pyRevit</span>
    <span class="c1"># Conflicts with PyRevit. Must Ensure exact path is specified</span>
    <span class="c1"># https://github.com/architecture-building-systems/revitpythonshell/issues/46</span>
    <span class="n">clr</span><span class="o">.</span><span class="n">AddReferenceToFileAndPath</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Program Files (x86)\IronPython 2.7\Platforms\Net40\IronPython.Wpf.dll&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">wpf</span>
    <span class="c1"># on 2.7.7 this raises wpf import error</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># IronPython 2.7.7 - pyRevit</span>
    <span class="c1"># clr.AddReference(&#39;IronPython&#39;)    # Works W/Out</span>
    <span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s1">&#39;IronPython.Wpf&#39;</span><span class="p">)</span>  <span class="c1"># 2.7.</span>
    <span class="kn">from</span> <span class="nn">IronPython.Modules</span> <span class="k">import</span> <span class="n">Wpf</span> <span class="k">as</span> <span class="n">wpf</span>
    <span class="c1"># on 2.7.7 this works. On 2.7.3 you get a LoadComponent 3 args error</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utils.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geometry.html" class="btn btn-neutral" title="Geometry" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Gui Talarico.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>