

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tests &mdash; Revit Python Wrapper 1.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Revit Python Wrapper 1.3.0 documentation" href="index.html"/>
        <link rel="prev" title="Known Issues" href="known_issues.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Revit Python Wrapper
          

          
          </a>

          
            
            
              <div class="version">
                1.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Revit Python Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="revit.html">Revit</a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Base Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="element.html">Element Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection.html">Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="collector.html">Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="view.html">View</a></li>
<li class="toctree-l1"><a class="reference internal" href="pattern.html">Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="builtins.html">BuiltIns</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="curve.html">Curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="forms.html">Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamo.html">Dynamo</a></li>
<li class="toctree-l1"><a class="reference internal" href="revitpythonshell.html">RevitPythonShell</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#test-suite">Test Suite</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Revit Python Wrapper</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tests</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tests.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tests">
<h1>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h1>
<p>The Test Suite below is used to verify functionalities, as well as to
validate compatibility across different platforms. These tests below have
been executed without failures on:</p>
<blockquote>
<div><ul class="simple">
<li>Revit 2015</li>
<li>Revit 2016</li>
<li>Revit 2017</li>
<li>Dynamo 1.2</li>
</ul>
</div></blockquote>
<p>The Test Suite also provides a many
examples of how the library is intended to be used.</p>
<hr class="docutils" />
<div class="section" id="test-suite">
<h2>Test Suite<a class="headerlink" href="#test-suite" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Globals</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="c1">######################</span>
<span class="c1"># Globals</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">Globals</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">rpw</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;Document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span>
        <span class="n">Wall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span> <span class="s1">&#39;Wall&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">Wall</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">UI</span>
        <span class="n">TaskDialog</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">UI</span><span class="p">,</span> <span class="s1">&#39;TaskDialog&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">TaskDialog</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_uidoc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39;UIApplication&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>
        <span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">LoggerWrapper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">LoggerWrapper</span><span class="p">)</span>

    <span class="c1">#TODO: test version</span>
    <span class="c1">#TODO: test built</span>



</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Collector Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>

<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>

<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP COLLECTOR TESTS...&#39;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;REVIT </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">version</span><span class="p">))</span>
    <span class="n">uidoc</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="n">OpenAndActivateDocument</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">panel_dir</span><span class="p">,</span> <span class="s1">&#39;collector.rvt&#39;</span><span class="p">))</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

<span class="c1">######################</span>
<span class="c1"># COLLECTOR</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">CollectorTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING COLLECTOR...&#39;</span><span class="p">)</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">family_loaded</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">OfCategory</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Furniture</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">collector_helper</span><span class="p">(</span><span class="n">filters</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filters</span><span class="p">))</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="o">**</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">elements</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">collector</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">collector</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">collector</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">collector</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span> <span class="o">=</span> <span class="n">CollectorTests</span><span class="o">.</span><span class="n">collector_helper</span>

    <span class="k">def</span> <span class="nf">test_collector_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_elements_view_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span> <span class="n">uidoc</span><span class="o">.</span><span class="n">ActiveView</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_elements_view_element_another</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Id of view where everything is hidden</span>
        <span class="n">view_hidden</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">GetElement</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="mi">12531</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span> <span class="n">view_hidden</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_elements_view_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span> <span class="n">uidoc</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">Id</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">test_collector_first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_caster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">})</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_class&#39;</span><span class="p">:</span> <span class="s1">&#39;Wall&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_is_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">walls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_category&#39;</span><span class="p">:</span> <span class="s1">&#39;OST_Walls&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;is_not_type&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">walls</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_collector_is_element_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">walls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_category&#39;</span><span class="p">:</span> <span class="s1">&#39;OST_Walls&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;is_not_type&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">walls</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_collector_is_element_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">walls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_category&#39;</span><span class="p">:</span> <span class="s1">&#39;OST_Walls&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;is_type&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">walls</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_collector_is_element_type_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">walls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_category&#39;</span><span class="p">:</span> <span class="s1">&#39;OST_Walls&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;is_type&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">walls</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_collector_is_view_dependent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fregions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;of_category&#39;</span><span class="p">:</span> <span class="s1">&#39;OST_FilledRegion&#39;</span><span class="p">})</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">ViewSpecific</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fregions</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>
        <span class="n">view_dependent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector_helper</span><span class="p">({</span><span class="s1">&#39;is_view_independent&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">ViewSpecific</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">view_dependent</span><span class="o">.</span><span class="n">elements</span><span class="p">])</span>

    <span class="c1"># def test_collector_chained_calls(self):</span>
    <span class="c1">#     wall_collector = self.collector_helper({&#39;of_category&#39;: DB.BuiltInCategory.OST_Walls})</span>
    <span class="c1">#     walls_category = len(wall_collector)</span>
    <span class="c1">#     wall_collector.filter(is_not_type=True)</span>
    <span class="c1">#     walls_elements = len(wall_collector)</span>
    <span class="c1">#     wall_collector.filter(is_type=True)</span>
    <span class="c1">#     walls_element_type = len(wall_collector)</span>
    <span class="c1">#     assert walls_category &gt; walls_elements &gt; walls_element_type</span>

    <span class="k">def</span> <span class="nf">tests_collect_rooms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s1">&#39;OST_Rooms&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">collector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">collector</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">SpatialElement</span><span class="p">)</span>
            <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;SpatialElement&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">collector</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Architecture</span><span class="o">.</span><span class="n">Room</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_scope_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If Collector scope is list of elements, should not find View&quot;&quot;&quot;</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="n">wall</span><span class="p">],</span> <span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;View&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collector</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_scope_element_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">element_ids</span><span class="o">=</span><span class="p">[</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="p">],</span> <span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;View&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collector</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_collector_symbol_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">desk_types</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;FamilySymbol&#39;</span><span class="p">,</span>
                                      <span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Furniture&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">desk_types</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">all_symbols</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;FamilySymbol&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_symbols</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">all_symbols</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;FamilySymbol&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elements</span>

        <span class="c1">#Placed Twice</span>
        <span class="n">first_symbol</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">desk_types</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_symbol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1">#Placed Once</span>
        <span class="n">second_symbol</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">desk_types</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">second_symbol</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">second_symbol</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">desk_types</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">second_symbol</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">##############################</span>
<span class="c1"># Built in Element Collector #</span>
<span class="c1">##############################</span>

<span class="k">class</span> <span class="nc">BuiltInCollectorTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING ELEMENT COLLECTOR...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collector_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">walls</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Wall</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">walls</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">walls</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collector_wallsymbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wallsymbols</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">WallType</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wallsymbols</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wallsymbols</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collector_Room</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rooms</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Room</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rooms</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rooms</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Architecture</span><span class="o">.</span><span class="n">Room</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collector_Area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">areas</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Area</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">areas</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collector_AreaScheme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">areas</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">AreaScheme</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">areas</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">AreaScheme</span><span class="p">)</span>


<span class="c1">############################</span>
<span class="c1"># COLLECTOR PARAMETER FILTER</span>
<span class="c1">############################</span>

<span class="k">class</span> <span class="nc">ParameterFilterTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING PARAMETER FILTER...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set Comment&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Tests&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">12.0</span>

        <span class="c1"># BIP Ids</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">builtins</span><span class="o">.</span><span class="n">BipEnum</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="s1">&#39;WALL_USER_HEIGHT_PARAM&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_id_location</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">builtins</span><span class="o">.</span><span class="n">BipEnum</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="s1">&#39;WALL_KEY_REF_PARAM&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">builtins</span><span class="o">.</span><span class="n">BipEnum</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="s1">&#39;ALL_MODEL_INSTANCE_COMMENTS&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_id_level_name</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">builtins</span><span class="o">.</span><span class="n">BipEnum</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="s1">&#39;DATUM_TEXT&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_less_no</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">less</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_less_yes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">less</span><span class="o">=</span><span class="mf">15.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_not_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">not_equals</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_greater</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">greater</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_multi_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">greater</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">less</span><span class="o">=</span><span class="mf">14.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_float_multi_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_height</span><span class="p">,</span> <span class="n">greater</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">not_less</span><span class="o">=</span><span class="mf">14.0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_int_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_location</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_filter_int_less</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_location</span><span class="p">,</span> <span class="n">less</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_comments_equals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="s1">&#39;Tests&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_comments_not_equals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="s1">&#39;Blaa&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_comments_begins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span><span class="p">,</span> <span class="n">begins</span><span class="o">=</span><span class="s1">&#39;Tes&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_comments_not_begins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="s1">&#39;Bla bla&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_param_comments_not_begins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_comments</span><span class="p">,</span> <span class="n">not_begins</span><span class="o">=</span><span class="s1">&#39;Bla bla&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;Wall&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># FAILS - CASE SENSITIVE FLAG IS NOT WORKING</span>
    <span class="c1"># def test_param_comments_equal_case(self):</span>
        <span class="c1"># parameter_filter = rpw.db.ParameterFilter(self.param_id_comments, contains=&#39;tests&#39;)</span>
        <span class="c1"># col = rpw.db.Collector(of_class=&quot;Wall&quot;, parameter_filter=parameter_filter)</span>
        <span class="c1"># self.assertEqual(len(col), 0)</span>

    <span class="k">def</span> <span class="nf">tests_param_name_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_level_name</span><span class="p">,</span> <span class="n">contains</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Levels&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_param_name_ends</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_id_level_name</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Levels&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_param_id_coerce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Uses Param Name instead of Param Id. Works only for BIP &quot;&quot;&quot;</span>
        <span class="n">param_name</span> <span class="o">=</span> <span class="s1">&#39;DATUM_TEXT&#39;</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Levels&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_from_parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Uses LooksUp Parameter from sample element &quot;&quot;&quot;</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Levels&quot;</span><span class="p">,</span> <span class="n">is_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="n">parameter_filter</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ParameterFilter</span><span class="o">.</span><span class="n">from_element_and_parameter</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;OST_Levels&quot;</span><span class="p">,</span> <span class="n">parameter_filter</span><span class="o">=</span><span class="n">parameter_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FilteredCollectorCompareTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING COLLECTOR...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfCategory</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Levels</span><span class="p">)</span><span class="o">.</span><span class="n">WhereElementIsElementType</span><span class="p">()</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>
        <span class="n">rv2</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;Levels&quot;</span><span class="p">,</span> <span class="n">is_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rv2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_category2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfCategory</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Levels</span><span class="p">)</span><span class="o">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>
        <span class="n">rv2</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s2">&quot;Levels&quot;</span><span class="p">,</span> <span class="n">is_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rv2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>
        <span class="n">rv2</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s2">&quot;View&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rv2</span><span class="p">))</span>

        <span class="c1">#TODO: Fo all FilteredElementCollector</span>

</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Collector Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>

<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>

<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.db.xyz</span> <span class="k">import</span> <span class="n">XYZ</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP COLLECTION TESTS...&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

<span class="c1">######################</span>
<span class="c1"># ElementSet</span>
<span class="c1">######################</span>

<span class="k">class</span> <span class="nc">ElementSetTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING ElementSetTests...&#39;</span><span class="p">)</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">views</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>

    <span class="c1"># def setUp(self):</span>
        <span class="c1"># self.collector_helper = CollectorTests.collector_helper</span>


    <span class="k">def</span> <span class="nf">test_element_set_element_add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">()</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_set_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">()</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_set_init__bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_element_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">element_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_element_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_as_element_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">as_element_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_set_as_element_id_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">as_element_id_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_set_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_element_set_first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_get_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">test_element_set_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">first_id</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">element_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">first_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span><span class="n">first_id</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_wrapped_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span><span class="o">.</span><span class="n">wrapped_elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>



<span class="c1">######################</span>
<span class="c1"># ElementCollection</span>
<span class="c1">######################</span>

<span class="k">class</span> <span class="nc">ElementCollectionTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING ElementCollection...&#39;</span><span class="p">)</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">views</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_element_collection_element_add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">()</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_collection_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">()</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_init__bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_element_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">element_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_element_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_as_element_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">as_element_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_collection_as_element_id_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">as_element_id_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_element_collection_select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_element_collection_first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_get_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">test_element_collection_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_collection_wrapped_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ElementSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="p">)</span><span class="o">.</span><span class="n">wrapped_elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>


<span class="c1">######################</span>
<span class="c1"># XYZCollection</span>
<span class="c1">######################</span>

<span class="k">class</span> <span class="nc">XyzCollectionTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING XYZ Collection...&#39;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">test_xyz_add_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">xyz_collection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">XyzCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xyz_collection</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">xyz_collection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">XyzCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="n">xyz_collection</span><span class="o">.</span><span class="n">max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_xyz_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">xyz_collection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">XyzCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">mn</span> <span class="o">=</span> <span class="n">xyz_collection</span><span class="o">.</span><span class="n">min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_xyz_average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">xyz_collection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">XyzCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">av</span> <span class="o">=</span> <span class="n">xyz_collection</span><span class="o">.</span><span class="n">average</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">av</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_xyz_sorted_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">xyz_collection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">XyzCollection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">xyz_collection</span><span class="o">.</span><span class="n">sorted_by</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>


</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Curve Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span><span class="p">,</span> <span class="n">db</span>

<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>

<span class="kn">from</span> <span class="nn">rpw.db.xyz</span> <span class="k">import</span> <span class="n">XYZ</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>


<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP Curve TESTS...&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Line</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING Line...&#39;</span><span class="p">)</span>
        <span class="n">pt1</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pt2</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">Line</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">CreateBound</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Line</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Line</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">end_point</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">test_line_start_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Line</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Line</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">start_point</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">test_line_end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Line</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Line</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">end_point</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">test_line_end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Line</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Line</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">mid_point</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">test_line_end_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Line</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">end_points</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Line</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">end_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()))</span>


<span class="k">class</span> <span class="nc">Ellipse</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING Line...&#39;</span><span class="p">)</span>
        <span class="n">pt1</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pt2</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">Line</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">CreateBound</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>

    <span class="c1"># def test_line(self):</span>
    <span class="c1">#     Line, line = self.Line, self.line</span>
    <span class="c1">#     self.assertIsInstance(line.unwrap(), DB.Line)</span>
    <span class="c1">#     self.assertTrue(Line.GetEndPoint(1).IsAlmostEqualTo(line.end_point.unwrap()))</span>
    <span class="c1">#</span>
    <span class="c1"># def test_line_start_point(self):</span>
    <span class="c1">#     Line, line = self.Line, self.line</span>
    <span class="c1">#     self.assertTrue(Line.GetEndPoint(0).IsAlmostEqualTo(line.start_point.unwrap()))</span>
    <span class="c1">#</span>
    <span class="c1"># def test_line_end_point(self):</span>
    <span class="c1">#     Line, line = self.Line, self.line</span>
    <span class="c1">#     self.assertTrue(Line.GetEndPoint(1).IsAlmostEqualTo(line.end_point.unwrap()))</span>
    <span class="c1">#</span>
    <span class="c1"># def test_line_end_point(self):</span>
    <span class="c1">#     Line, line = self.Line, self.line</span>
    <span class="c1">#     self.assertTrue(Line.GetEndPoint(0.5).IsAlmostEqualTo(line.mid_point.unwrap()))</span>
    <span class="c1">#</span>
    <span class="c1"># def test_line_end_points(self):</span>
    <span class="c1">#     Line, line = self.Line, self.line</span>
    <span class="c1">#     self.assertIsInstance(line.end_points, tuple)</span>
    <span class="c1">#     self.assertTrue(Line.GetEndPoint(0).IsAlmostEqualTo(line.end_points[0].unwrap()))</span>


<span class="k">class</span> <span class="nc">CurveCreate</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING Curve Create...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">new</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detail_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">create_detail</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_line</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_detail_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_line</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">DetailLine</span><span class="p">)</span>
        <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_line</span><span class="o">.</span><span class="n">GeometryCurve</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">GetEndPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">IsAlmostEqualTo</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>


</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Collector Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span><span class="p">,</span> <span class="n">RpwCoerceError</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP ELEMENTS TESTS...&#39;</span><span class="p">)</span>
    <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="n">OpenAndActivateDocument</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">panel_dir</span><span class="p">,</span> <span class="s1">&#39;collector.rvt&#39;</span><span class="p">))</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>


<span class="c1">######################</span>
<span class="c1"># ELEMENT</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">ElementTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING ELEMENT...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)</span>
        <span class="c1"># param = self.wall.LookupParameter(&#39;Comments&#39;)</span>
        <span class="c1"># t = DB.Transaction(doc)</span>
        <span class="c1"># t.Start(&#39;Clear Comment Param&#39;)</span>
        <span class="c1"># param.Set(&#39;&#39;)</span>
        <span class="c1"># t.Commit()</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="n">DB</span><span class="o">.</span><span class="n">Level</span><span class="p">)</span><span class="o">.</span><span class="n">elements</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Delete Test Levels&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">level</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;&lt;RPW_Element:&lt;Autodesk.Revit.DB.Wall&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_element_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_from_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">from_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_from_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">from_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_get_parameter_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Base Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Room Bounding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_get_parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="s1">&#39;Comments&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_get_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_element_set_get_parameter_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Test String&#39;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="s1">&#39;Test String&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_element_set_get_parameter_coerce_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_element_set_get_parameter_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set Integer&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">5.0</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_element_set_get_parameter_coerce_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set Coerce Int&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_element_set_get_parameter_element_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">active_view</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span><span class="o">.</span><span class="n">ActiveView</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">active_view</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Create and Set Level&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new_level</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">Level</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">new_level</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">Create</span><span class="o">.</span><span class="n">NewLevel</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Top Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new_level</span><span class="o">.</span><span class="n">Id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Top Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">,</span>
                         <span class="n">new_level</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_get_builtin_parameter_by_strin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="s1">&#39;WALL_KEY_REF_PARAM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">bip</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_set_get_builtin_parameter_by_strin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="s1">&#39;WALL_KEY_REF_PARAM&#39;</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set Value&#39;</span><span class="p">):</span>
            <span class="n">bip</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">bip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="s1">&#39;WALL_KEY_REF_PARAM&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bip</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_get_builtin_parameter_caster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="s1">&#39;WALL_KEY_REF_PARAM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">BIP_ENUM</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInParameter</span><span class="o">.</span><span class="n">WALL_KEY_REF_PARAM</span>
        <span class="n">bip2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="n">BIP_ENUM</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">bip</span><span class="p">,</span> <span class="n">bip2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tests_wrong_storage_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">RpwWrongStorageType</span><span class="p">)</span> <span class="k">as</span> <span class="n">context</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Unconnected Height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>

    <span class="k">def</span> <span class="nf">test_parameter_does_not_exist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">RpwParameterNotFound</span><span class="p">)</span> <span class="k">as</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Parameter Name&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">test_built_in_parameter_exception_raised</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">RpwCoerceError</span><span class="p">)</span> <span class="k">as</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_wall</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">builtins</span><span class="p">[</span><span class="s1">&#39;PARAMETERD_DOES_NOT_EXIST&#39;</span><span class="p">]</span>


<span class="c1">#########################</span>
<span class="c1"># Parameters / Isolated #</span>
<span class="c1">#########################</span>

    <span class="k">def</span> <span class="nf">tests_param_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">LookupParameter</span><span class="p">(</span><span class="s1">&#39;Comments&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Parameter</span><span class="p">)</span>
        <span class="n">wrapped_param</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">wrapped_param</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wrapped_param</span><span class="o">.</span><span class="n">builtin</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInParameter</span><span class="o">.</span><span class="n">ALL_MODEL_INSTANCE_COMMENTS</span><span class="p">)</span>

<span class="c1">################################### INSTANCES / Symbols / Families #</span>
<span class="c1">##################################</span>

<span class="k">class</span> <span class="nc">InstanceTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING INSTANCES...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_category</span><span class="o">=</span><span class="s1">&#39;OST_Furniture&#39;</span><span class="p">,</span> <span class="n">is_not_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;SELECTION TEST PASSED&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_instance_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_instance_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FamilySymbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">FamilySymbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;60&quot; x 30&quot;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">instances</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">siblings</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_instance_family</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">family</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Family</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;desk&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Family</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">instances</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">siblings</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_instance_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Category</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Category</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Furniture&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">instances</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="n">families</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_element_factory_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">symbol</span>
        <span class="n">family</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">family</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()),</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="n">symbol</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()),</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FamilySymbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()),</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Family</span><span class="p">)</span>

        <span class="c1"># TODO: Move this. Category No Longer Element</span>
        <span class="c1"># self.assertIsInstance(rpw.db.Element.Factory(category.unwrap()), rpw.db.Category)</span>


<span class="c1">##################################################</span>
<span class="c1"># Wall / Wall Types / Wall Kind / Wall Category  #</span>
<span class="c1">##################################################</span>

<span class="k">class</span> <span class="nc">WallTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING WALL...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">,</span> <span class="n">is_not_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Wall</span><span class="p">(</span><span class="n">wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_wall_instance_wrap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>
        <span class="n">wrapped</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span>
        <span class="c1"># TODO: MOVE THESE &gt; No Longer Element</span>
        <span class="n">wrapped</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">WallKind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">WallKind</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_instance_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_symbol</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_symbol</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">WallType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall_symbol</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Wall 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wall_symbol</span><span class="o">.</span><span class="n">instances</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wall_symbol</span><span class="o">.</span><span class="n">siblings</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_instance_family</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall_family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">family</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_family</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">WallKind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall_family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">WallKind</span><span class="o">.</span><span class="n">Basic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall_family</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Basic Wall&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wall_family</span><span class="o">.</span><span class="n">instances</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wall_family</span><span class="o">.</span><span class="n">symbols</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_instance_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall_category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_category</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">WallCategory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_category</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Category</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall_category</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Walls&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_instance_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall_category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_category</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">WallCategory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall_category</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Category</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall_category</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Walls&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_change_type_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="n">wall</span><span class="o">.</span><span class="n">change_type</span><span class="p">(</span><span class="s1">&#39;Wall 2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall</span><span class="o">.</span><span class="n">wall_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Wall 2&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_wall_change_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span>
        <span class="n">wall_type</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;WallType&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Wall 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="n">wall</span><span class="o">.</span><span class="n">change_type</span><span class="p">(</span><span class="s1">&#39;Wall 2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wall</span><span class="o">.</span><span class="n">wall_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Wall 2&#39;</span><span class="p">)</span>

<span class="c1">##################</span>
<span class="c1"># Rooms / Areas  #</span>
<span class="c1">##################</span>

<span class="k">class</span> <span class="nc">RoomTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c1"># t = DB.Transaction(doc)</span>
        <span class="c1"># t.Start(&#39;Add Room&#39;)</span>


    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">room</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">os_category</span><span class="o">=</span><span class="s1">&#39;OST_Rooms&#39;</span><span class="p">,</span> <span class="n">is_not_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Wall</span><span class="p">(</span><span class="n">wall</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># def test_wall_instance_wrap(self):</span>
    <span class="c1">#     self.assertIsInstance(self.wall, rpw.db.wall.Wall)</span>
    <span class="c1">#     self.assertIsInstance(self.wall.unwrap(), DB.Wall)</span>



</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Selection Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>
<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP SELECTION TESTS...&#39;</span><span class="p">)</span>
    <span class="c1"># uidoc.Application.OpenAndActivateDocument(os.path.join(panel_dir, &#39;collector.rvt&#39;))</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="c1">######################</span>
<span class="c1"># SELECTION</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">SelectionTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING SELECTION...&#39;</span><span class="p">)</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">wall</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tearDownClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">SelectionTests</span><span class="o">.</span><span class="n">wall</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;SELECTION TEST PASSED&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_element_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">element_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span>
                        <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span> <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
                        <span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_selection_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span>
                        <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">]</span>
                        <span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_selection_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wall</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_boolean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_boolean_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">test_selection_add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">()</span>
        <span class="n">selection</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">()</span>
        <span class="n">selection</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">,</span> <span class="n">selection</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_updates_does_not_lose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">()</span>
        <span class="n">selection2</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">()</span>
        <span class="n">selection2</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">selection2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_selection_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Selection</span><span class="p">()</span>
        <span class="n">selection</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Utils Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="kn">from</span> <span class="nn">rpw.db</span> <span class="k">import</span> <span class="n">Element</span>
<span class="kn">from</span> <span class="nn">rpw.db</span> <span class="k">import</span> <span class="n">View</span><span class="p">,</span> <span class="n">ViewPlan</span><span class="p">,</span> <span class="n">ViewSection</span>
<span class="kn">from</span> <span class="nn">rpw.db</span> <span class="k">import</span> <span class="n">ViewSheet</span><span class="p">,</span> <span class="n">ViewSchedule</span><span class="p">,</span> <span class="n">View3D</span>
<span class="kn">from</span> <span class="nn">rpw.db</span> <span class="k">import</span> <span class="n">ViewFamilyType</span>
<span class="kn">from</span> <span class="nn">rpw.db</span> <span class="k">import</span> <span class="n">ViewType</span><span class="p">,</span> <span class="n">ViewPlanType</span>

<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="c1"># from rpw.utils.dotnet import List</span>
<span class="c1"># from rpw.exceptions import RpwParameterNotFound, RpwWrongStorageType</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP VIEW TESTS...&#39;</span><span class="p">)</span>
    <span class="c1"># test_utils.delete_all_walls()</span>
    <span class="c1"># test_utils.make_wall()</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>
    <span class="c1"># test_utils.delete_all_walls()</span>

<span class="k">class</span> <span class="nc">TestViewWrappers</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING View Classes...&#39;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_plan</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewPlan</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_sheet</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSheet</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_schedule</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSchedule</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_section</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSection</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_3d</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View3D</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_family_type</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewFamilyType</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_view_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view</span><span class="p">,</span> <span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_plan_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_plan</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_plan</span><span class="p">,</span> <span class="n">ViewPlan</span><span class="p">)</span>
        <span class="n">wrapped_view_plan</span> <span class="o">=</span> <span class="n">ViewPlan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_plan</span><span class="p">,</span> <span class="n">ViewPlan</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_section_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_section</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_section</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_section</span><span class="p">,</span> <span class="n">ViewSection</span><span class="p">)</span>
        <span class="n">wrapped_view_section</span> <span class="o">=</span> <span class="n">ViewSection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_section</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_section</span><span class="p">,</span> <span class="n">ViewSection</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_sheet_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_sheet</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_sheet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_sheet</span><span class="p">,</span> <span class="n">ViewSheet</span><span class="p">)</span>
        <span class="n">wrapped_view_sheet</span> <span class="o">=</span> <span class="n">ViewSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_sheet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_sheet</span><span class="p">,</span> <span class="n">ViewSheet</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_schedule_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_schedule</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_schedule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_schedule</span><span class="p">,</span> <span class="n">ViewSchedule</span><span class="p">)</span>
        <span class="n">wrapped_view_schedule</span> <span class="o">=</span> <span class="n">ViewSchedule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_schedule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_schedule</span><span class="p">,</span> <span class="n">ViewSchedule</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_3d</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_3d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_3d</span><span class="p">,</span> <span class="n">View3D</span><span class="p">)</span>
        <span class="n">wrapped_view_3d</span> <span class="o">=</span> <span class="n">View3D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_3d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_3d</span><span class="p">,</span> <span class="n">View3D</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_family_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_family_type</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_family_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_family_type</span><span class="p">,</span> <span class="n">ViewFamilyType</span><span class="p">)</span>
        <span class="n">wrapped_view_family_type</span> <span class="o">=</span> <span class="n">ViewFamilyType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_family_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">wrapped_view_family_type</span><span class="p">,</span> <span class="n">ViewFamilyType</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">TestViewRelationships</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING View Classes...&#39;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_plan</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewPlan</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_sheet</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSheet</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_schedule</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSchedule</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_section</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewSection</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_3d</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">View3D</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_family_type</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ViewFamilyType</span><span class="p">)</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_view_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_3d</span><span class="p">)</span>
        <span class="n">view_type</span> <span class="o">=</span> <span class="n">wrapped_view</span><span class="o">.</span><span class="n">view_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">view_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">view_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ThreeD</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">view_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;ThreeD&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_plan_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">wrapped_view</span><span class="o">.</span><span class="n">level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_family_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_3d</span><span class="p">)</span>
        <span class="n">view_type</span> <span class="o">=</span> <span class="n">wrapped_view</span><span class="o">.</span><span class="n">view_family_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">view_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewFamilyType</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_family</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_3d</span><span class="p">)</span>
        <span class="n">view_family</span> <span class="o">=</span> <span class="n">wrapped_view</span><span class="o">.</span><span class="n">view_family</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">view_family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewFamily</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_type_aggregator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_plan</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="n">same_view_type_views</span> <span class="o">=</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_type</span><span class="o">.</span><span class="n">views</span>
        <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">same_view_type_views</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">view_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_view_family_aggregator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_plan</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="n">same_family_views</span> <span class="o">=</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_family</span><span class="o">.</span><span class="n">views</span>
        <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">same_family_views</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">view_family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_family</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_view_family_aggregator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view_plan</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="p">)</span>
        <span class="n">same_view_family_type_views</span> <span class="o">=</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_family_type</span><span class="o">.</span><span class="n">views</span>
        <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">same_view_family_type_views</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">view_family_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">wrapped_view_plan</span><span class="o">.</span><span class="n">view_family_type</span><span class="o">.</span><span class="n">unwrap</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_view_family_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ViewPlan</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">view_family_type</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Floor Plan&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">wrapped_elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">view_family_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;Floor Plan&#39;</span><span class="p">)</span>

    <span class="c1"># def test_view_family_type_name_get_setter(self):</span>
    <span class="c1">#     wrapped_view = rpw.db.ViewPlan.collect(where=lambda x: x.view_family_type.name == &#39;My Floor Plan&#39;).wrapped_elements[0]</span>
    <span class="c1">#     # self.assertEqual(wrapped_view.view_family_type.name, &#39;My Floor Plan&#39;)</span>
    <span class="c1">#     with rpw.db.Transaction(&#39;Set Name&#39;):</span>
    <span class="c1">#         wrapped_view.view_family_type.name = &#39;ABC&#39;</span>
    <span class="c1">#     self.assertEqual(wrapped_view.view_family_type.name, &#39;ABC&#39;)</span>
        <span class="c1"># with rpw.db.Transaction(&#39;Set Name&#39;):</span>
            <span class="c1"># wrapped_view.view_family_type.name = &#39;My Floor Plan&#39;</span>
        <span class="c1"># rpw.ui.forms.Console()</span>

<span class="k">class</span> <span class="nc">TestViewOverrides</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING View Classes...&#39;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">view_plan</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">active_view</span><span class="o">.</span><span class="n">unwrap</span><span class="p">()</span>
        <span class="c1"># cls.view_plan = DB.FilteredElementCollector(revit.doc).OfClass(DB.ViewPlan).FirstElement()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">wrapped_view</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">active_view</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span><span class="o">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span><span class="o">.</span><span class="n">FirstElement</span><span class="p">()</span>

        <span class="n">linepattern</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;LinePatternElement&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Name</span> <span class="o">==</span> <span class="s1">&#39;Dash&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">line_pattern_id</span> <span class="o">=</span> <span class="n">linepattern</span><span class="o">.</span><span class="n">Id</span>
        <span class="n">fillpattern</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;FillPatternElement&#39;</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Name</span> <span class="o">==</span> <span class="s1">&#39;Horizontal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">fillpattern_id</span> <span class="o">=</span> <span class="n">fillpattern</span><span class="o">.</span><span class="n">Id</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Resets Element after each test &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">SetElementOverrides</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">OverrideGraphicSettings</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_match</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span><span class="o">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">FamilyInstance</span><span class="p">)</span><span class="o">.</span><span class="n">WhereElementIsNotElementType</span><span class="p">()</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">OverrideGraphicSettings</span><span class="p">()</span>
        <span class="n">o</span><span class="o">.</span><span class="n">SetHalftone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">o</span><span class="o">.</span><span class="n">SetSurfaceTransparency</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">SetElementOverrides</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">match_element</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Halftone</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Transparency</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_halftone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">halftone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Halftone</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_halftone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">halftone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Halftone</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transparency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">transparency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Transparency</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_detail_level_by_enum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">detail_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewDetailLevel</span><span class="o">.</span><span class="n">Fine</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">DetailLevel</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewDetailLevel</span><span class="o">.</span><span class="n">Fine</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_detail_level_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">detail_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="s1">&#39;Fine&#39;</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">DetailLevel</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ViewDetailLevel</span><span class="o">.</span><span class="n">Fine</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_projection_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">projection_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
                                                       <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span>
                                                       <span class="n">weight</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                       <span class="n">pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLineColor</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLineColor</span><span class="o">.</span><span class="n">Green</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLineColor</span><span class="o">.</span><span class="n">Blue</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLineWeight</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLinePatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_projection_line_pattern_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">projection_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;Dash&#39;</span><span class="p">)</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionLinePatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_cut_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">cut_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
                                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">150</span><span class="p">),</span>
                                                <span class="n">weight</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                                <span class="n">pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLineColor</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLineColor</span><span class="o">.</span><span class="n">Green</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLineColor</span><span class="o">.</span><span class="n">Blue</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLineWeight</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLinePatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_cut_line_pattern_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">cut_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;Dash&#39;</span><span class="p">)</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutLinePatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_pattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_projection_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">projection_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
                                                       <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">190</span><span class="p">),</span>
                                                       <span class="n">pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">,</span>
                                                       <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionFillColor</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionFillColor</span><span class="o">.</span><span class="n">Green</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionFillColor</span><span class="o">.</span><span class="n">Blue</span><span class="p">,</span> <span class="mi">190</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">IsProjectionFillPatternVisible</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionFillPatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_projection_fill_pattern_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">projection_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;Horizontal&#39;</span><span class="p">)</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ProjectionFillPatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_cut_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">cut_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
                                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span>
                                                <span class="n">pattern</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">,</span>
                                                <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutFillColor</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutFillColor</span><span class="o">.</span><span class="n">Green</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutFillColor</span><span class="o">.</span><span class="n">Blue</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">IsCutFillPatternVisible</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutFillPatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">test_cut_fill_pattern_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">cut_fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;Horizontal&#39;</span><span class="p">)</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetElementOverrides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">CutFillPatternId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillpattern_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_halftone_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">halftone</span><span class="p">(</span><span class="s1">&#39;Furniture&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetCategoryOverrides</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Furniture</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Halftone</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_halftone_category_bi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_view</span><span class="o">.</span><span class="n">override</span><span class="o">.</span><span class="n">halftone</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Furniture</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_plan</span><span class="o">.</span><span class="n">GetCategoryOverrides</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Furniture</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">Halftone</span><span class="p">)</span>


</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">XYZ Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>

<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>

<span class="kn">from</span> <span class="nn">rpw.db.xyz</span> <span class="k">import</span> <span class="n">XYZ</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="c1"># import test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP COLLECTION TESTS...&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>
    <span class="c1"># test_utils.delete_all_walls()</span>

<span class="c1">######################</span>
<span class="c1"># XYZTests</span>
<span class="c1">######################</span>

<span class="k">class</span> <span class="nc">XYZInitTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING XYZ...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_2args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_3args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_tuple2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_tuple3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_DB_XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_from_XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">XYZUsageTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING XYZ Usage...&#39;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">pt2</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_get_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_set_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">pt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">pt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">pt</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_at_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">at_z</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt_tuple</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt_tuple</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pt_tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt_dict</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">as_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">pt_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt_dict</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">test_xyz_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;&lt;rpw:XYZ&#39;</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_xyz_add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_mul</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_xyz_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">XYZ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>


</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Transaction Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP TRANSACTION TESTS...&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">TransactionsTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING TRANSACTIONS...&#39;</span><span class="p">)</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">wall</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tearDownClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">FilteredElementCollector</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">OfClass</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span><span class="o">.</span><span class="n">ToElements</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Wall</span><span class="p">(</span><span class="n">wall</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Reset Comment&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">test_transaction_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Test Is Instance&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transaction_started</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Has Started&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">HasStarted</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_transaction_has_ended</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Add Comment&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">HasEnded</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">test_transaction_get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Named Transaction&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="s1">&#39;Named Transaction&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transaction_commit_status_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Started</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Committed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transaction_commit_status_rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Top Constraint&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">RolledBack</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transaction_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">TransactionGroup</span><span class="p">(</span><span class="s1">&#39;Multiple Transactions&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Started</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="s1">&#39;Set String&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Started</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Committed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">GetStatus</span><span class="p">(),</span> <span class="n">DB</span><span class="o">.</span><span class="n">TransactionStatus</span><span class="o">.</span><span class="n">Committed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transaction_decorator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nd">@rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="s1">&#39;Transaction Name&#39;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">somefunction</span><span class="p">():</span>
            <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="k">return</span> <span class="n">param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">somefunction</span><span class="p">())</span>


</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Utils Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>

<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP UTILS TESTS...&#39;</span><span class="p">)</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">CoerceTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING COERCE FUNCITONS...&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Collector</span><span class="p">(</span><span class="n">of_class</span><span class="o">=</span><span class="s1">&#39;Wall&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_corce_into_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">id_</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_element_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_corce_into_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_element_ids</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">])</span>
        <span class="n">all_id</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">all_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_corce_element_ref_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_corce_element_ref_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wall_id</span> <span class="o">=</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_elements</span><span class="p">([</span><span class="n">wall_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">test_corce_to_element_diverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_elements</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="o">.</span><span class="n">Id</span><span class="o">.</span><span class="n">IntegerValue</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">DB</span><span class="o">.</span><span class="n">Element</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">test_to_class_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_class</span><span class="p">(</span><span class="s1">&#39;Wall&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">Wall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_to_class_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_class</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">View</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_to_category_walls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;Walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;ost_walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_to_category_id_walls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category_id</span><span class="p">(</span><span class="s1">&#39;Walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category_id</span><span class="p">(</span><span class="s1">&#39;walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category_id</span><span class="p">(</span><span class="s1">&#39;ost_walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">ElementId</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_Walls</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_to_category_stacked_walls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;ost_StackedWalls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_StackedWalls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;StackedWalls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_StackedWalls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;stackedwalls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_StackedWalls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIs</span><span class="p">(</span><span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_category</span><span class="p">(</span><span class="s1">&#39;stacked walls&#39;</span><span class="p">),</span> <span class="n">DB</span><span class="o">.</span><span class="n">BuiltInCategory</span><span class="o">.</span><span class="n">OST_StackedWalls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_to_iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">([</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_iterable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">test_to_iterable_element_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">([</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_element_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">test_to_iterable_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">([</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">rpw</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">coerce</span><span class="o">.</span><span class="n">to_elements</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall</span><span class="p">)])</span>


    <span class="c1"># TODO: Add BuiltInCategory Tests</span>
    <span class="c1"># CATEGORY COERCE</span>
    <span class="c1"># &gt;&gt;&gt; with rpw.db.Transaction():</span>
    <span class="c1"># ... 	rpw.revit.active_view.override.projection_line(BuiltInCategory.OST_Furniture, color=[255,0,255])</span>
    <span class="c1"># ...</span>
    <span class="c1"># &gt;&gt;&gt; with rpw.db.Transaction():</span>
    <span class="c1"># ... 	rpw.revit.active_view.override.projection_line(ElementId(BuiltInCategory.OST_Furniture), color=[255,0,255])</span>
    <span class="c1"># ...</span>
    <span class="c1"># &gt;&gt;&gt; with rpw.db.Transaction():</span>
    <span class="c1"># ... 	rpw.revit.active_view.override.projection_line(ElementId(BuiltInCategory.OST_Furniture), color=[255,0,120])</span>
    <span class="c1"># ...</span>
    <span class="c1"># &gt;&gt;&gt;</span>

</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Selection Tests</span>

<span class="sd">Passes:</span>
<span class="sd"> * 2017.1</span>

<span class="sd">Revit Python Wrapper</span>
<span class="sd">github.com/gtalarico/revitpythonwrapper</span>
<span class="sd">revitpythonwrapper.readthedocs.io</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights to</span>
<span class="sd">use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies</span>
<span class="sd">of the Software, and to permit persons to whom the Software is furnished to do</span>
<span class="sd">so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in</span>
<span class="sd">all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="sd">THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<span class="sd">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<span class="sd">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<span class="sd">OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="sd">Copyright 2017 Gui Talarico</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span>
<span class="n">script_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">panel_dir</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">script_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">rpw.ui.selection</span> <span class="k">import</span> <span class="n">Pick</span>
<span class="kn">from</span> <span class="nn">rpw.db.reference</span> <span class="k">import</span> <span class="n">Reference</span>
<span class="kn">from</span> <span class="nn">rpw.db.xyz</span> <span class="k">import</span> <span class="n">XYZ</span>
<span class="kn">from</span> <span class="nn">rpw.db.element</span> <span class="k">import</span> <span class="n">Element</span>

<span class="kn">import</span> <span class="nn">test_utils</span>

<span class="k">def</span> <span class="nf">setUpModule</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SETTING UP PICK TESTS...&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tearDownModule</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="c1">######################</span>
<span class="c1"># SELECTION</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">PickTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TESTING PICK...&#39;</span><span class="p">)</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="n">test_utils</span><span class="o">.</span><span class="n">make_wall</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">wall</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tearDownClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">test_utils</span><span class="o">.</span><span class="n">delete_all_walls</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wall</span> <span class="o">=</span> <span class="n">PickTests</span><span class="o">.</span><span class="n">wall</span>
        <span class="c1"># Pick().clear()</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Pick().clear()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;SELECTION TEST PASSED&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">desk</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_element</span><span class="p">(</span><span class="s1">&#39;Pick a Desk&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">desk</span><span class="p">,</span> <span class="n">Reference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">desks</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_element</span><span class="p">(</span><span class="s1">&#39;Pick 2 Desks&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">desks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Reference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_element_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_pt_on_element</span><span class="p">(</span><span class="s1">&#39;pick_pt_on_element&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">Reference</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_pt_on_element</span><span class="p">(</span><span class="s1">&#39;pick_pt_on_element&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Reference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_element_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_edge</span><span class="p">(</span><span class="s1">&#39;pick_edge&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">Reference</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_edge</span><span class="p">(</span><span class="s1">&#39;pick_edges&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Reference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_element_face</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_face</span><span class="p">(</span><span class="s1">&#39;pick_face&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">Reference</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_face</span><span class="p">(</span><span class="s1">&#39;pick_faces&#39;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Reference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_pt</span><span class="p">(</span><span class="s1">&#39;pick_pt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_snaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_pt</span><span class="p">(</span><span class="s1">&#39;pick_pt&#39;</span><span class="p">,</span> <span class="n">snap</span><span class="o">=</span><span class="s1">&#39;endpoints&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_box</span><span class="p">(</span><span class="s1">&#39;PickBox&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">XYZ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_pick_by_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Pick</span><span class="p">()</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">pick_by_rectangle</span><span class="p">(</span><span class="s1">&#39;Pick By Rectangle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">rv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Element</span><span class="p">)</span>

    <span class="c1"># def test_pick_linked(self):</span>
    <span class="c1">#     selection = Pick()</span>
    <span class="c1">#     rv = selection.pick_linked_element(&#39;pick_linked_element&#39;)</span>
    <span class="c1">#     rpw.ui.Console()</span>



</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Revit Python Wrapper Tests - Forms</span>

<span class="sd">Passes:</span>
<span class="sd">2017</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">test_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">test_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">rpw</span>
<span class="kn">from</span> <span class="nn">rpw</span> <span class="k">import</span> <span class="n">revit</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">UI</span>
<span class="n">doc</span><span class="p">,</span> <span class="n">uidoc</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">rpw</span><span class="o">.</span><span class="n">revit</span><span class="o">.</span><span class="n">uidoc</span>

<span class="kn">from</span> <span class="nn">rpw.utils.dotnet</span> <span class="k">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">rpw.exceptions</span> <span class="k">import</span> <span class="n">RpwParameterNotFound</span><span class="p">,</span> <span class="n">RpwWrongStorageType</span>
<span class="kn">from</span> <span class="nn">rpw.utils.logger</span> <span class="k">import</span> <span class="n">logger</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="c1">######################</span>
<span class="c1"># FORMS</span>
<span class="c1">######################</span>


<span class="k">class</span> <span class="nc">FormSelectFromListTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Select From List Test&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Select A and click select&#39;</span><span class="p">,</span>
                                        <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_get_dict_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Select From List Test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span>
                                            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Select A and click select&#39;</span><span class="p">,</span>
                                            <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Test Cancel&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;CLOSE WITHOUT SELECTING&#39;</span><span class="p">,</span>
                                        <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_close_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">SystemExit</span><span class="p">):</span>
            <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">SelectFromList</span><span class="p">(</span><span class="s1">&#39;Text Exit on Close&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;CLOSE WITHOUT SELECTING&#39;</span><span class="p">,</span>
                                        <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FormTextInputTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="s1">&#39;Text Input&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
                                       <span class="n">description</span><span class="o">=</span><span class="s1">&#39;select with letter A&#39;</span><span class="p">,</span>
                                       <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="s1">&#39;Test Cancel&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
                                   <span class="n">description</span><span class="o">=</span><span class="s1">&#39;CLOSE FORM&#39;</span><span class="p">,</span>
                                   <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNone</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_close_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">SystemExit</span><span class="p">):</span>
            <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span><span class="s1">&#39;Test Exit on Close&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
                                    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;CLOSE FORM&#39;</span><span class="p">,</span>
                                    <span class="n">exit_on_close</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FlexFormTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_flex_form_launch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">),</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Click Here&#39;</span><span class="p">)]</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;Text Input&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
        <span class="n">form_result</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">form_result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_flex_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">),</span>
                      <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">TextBox</span><span class="p">(</span><span class="s1">&#39;textbox&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Default Value&#39;</span><span class="p">),</span>
                      <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="s1">&#39;combo&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">),</span>
                      <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="s1">&#39;checkbox&#39;</span><span class="p">,</span> <span class="s1">&#39;SELECTED&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                      <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">Separator</span><span class="p">(),</span>
                      <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Click Here&#39;</span><span class="p">),</span>
                      <span class="p">]</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">rpw</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">forms</span><span class="o">.</span><span class="n">FlexForm</span><span class="p">(</span><span class="s1">&#39;Text Input&#39;</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
        <span class="n">form_result</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">form_result</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;checkbox&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;combo&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;textbox&#39;</span><span class="p">],</span> <span class="s1">&#39;Default Value&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="known_issues.html" class="btn btn-neutral" title="Known Issues" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Gui Talarico.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>